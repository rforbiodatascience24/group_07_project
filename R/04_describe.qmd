---
title: "Data Description"
output: html
execute:
  echo: true
  output: false
---

Load packages

```{r}
library(tidyverse)
```

Loading cleaned and augmented data and set colour pallets:

```{r}
# Data
pheno_expr_data_joined <- read_tsv(file = file.path(processed_data_dir,
                             "03_dat_joined.tsv"),
                      show_col_types = FALSE)

# Color palette
color_palette <- read_tsv(file = file.path(processed_data_dir,
                                         "04_col_pal.tsv"),
                     show_col_types = FALSE)
```

Number of observations and variables in the cleaned and augmented data set

```{r}
# Number of samples
str_glue("Number of samples {pheno_expr_data_joined |>
         nrow()}")


# Number of variables
str_glue("Number of variables {pheno_expr_data_joined |>
         ncol()}")

# Number of genes
str_glue("Number of genes {pheno_expr_data_joined |>
         ncol() - 4}")
```

Number of individuals by sex and species

```{r}
species_plot <- pheno_expr_data_joined |>
  ggplot(mapping = aes(x = fct_infreq(species),
                     fill = sex)) +
  geom_bar(color = "black") +
  theme_minimal() +
  theme(plot.title.position = "plot",
        legend.position = "none",
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        plot.subtitle = element_markdown(size = 12)) +
  labs(title = "Distribution of Species",
       subtitle = "By <span style='color:#9E3706'>male</span> and <span style='color:#DE580C'>female</span>",
       x = element_blank()) +
    scale_fill_manual(values = color_palette |>
                      filter(group == "Alternative") |>
                      slice_tail(n = 2) |>
                      pull(color))

species_plot
```

Distribution of population of dataset by age:

```{r}
sex_plot <- pheno_expr_data_joined |>
  ggplot(mapping = aes(x = age,
                       fill = species)) +
  geom_boxplot() +
  theme_minimal() +
  theme(plot.title.position = "plot",
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        axis.text.y = element_blank(),
        plot.subtitle = element_markdown(size = 12),
        legend.position = "none") +
  labs(title = "Distribution of Age",
       subtitle = "of <span style='color:#8ECF8F'>chimpanzees</span>,
       <span style='color:#459051'>humans</span> and <span style='color:#00441B'>macaque</span> in dataset") +
  scale_fill_manual(values = color_palette |>
                      filter(group == "Species") |>
                      pull(color))

sex_plot
```

```{r}
ggsave(file = file.path(processed_data_dir,
                        "04_species_plot.png"),
       plot = species_plot,
       width = 12,
       height = 8)

ggsave(file = file.path(processed_data_dir,
                        "04_sex_plot.png"),
       plot = sex_plot,
       width = 12,
       height = 8)
```
