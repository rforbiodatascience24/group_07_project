---
title: "Data Description"
output: html
execute:
  echo: true
  output: false
---

Load packages

```{r}
library(tidyverse)
```

Loading cleaned and augmented data and set colour pallets:

```{r}
# Data
pheno_expr_data_joined <- read_tsv(file = file.path(processed_data_dir,
                             "03_dat_joined.tsv"),
                      show_col_types = FALSE)

# Color palette
color_palette <- read_tsv(file = file.path(processed_data_dir,
                                         "04_col_pal.tsv"),
                     show_col_types = FALSE)
```

Number of observations and variables in the cleaned and augmented data set

```{r}
# Number of samples
str_glue("Number of samples {pheno_expr_data_joined |>
         nrow()}")


# Number of variables
str_glue("Number of variables {pheno_expr_data_joined |>
         ncol()}")

# Number of genes
str_glue("Number of genes {pheno_expr_data_joined |>
         ncol() - 4}")
```

Number of individuals by sex and species

```{r}
ggplot(data = pheno_expr_data_joined,
       mapping = aes(x = fct_infreq(species),
                     fill = sex)) +
  geom_bar(color = "black") +
  theme_minimal() +
  theme(plot.title.position = "plot",
        legend.position = "none",
       panel.grid.minor = element_blank(),
       panel.grid.major = element_blank()) +
  labs(title = "Distribution of Species",
       subtitle = "By <span style='color:#8ECF8F'>male</span> and <span style='color:#8ECF8F'>female</span>",
       x = element_blank()) +
    scale_fill_manual(values = color_palette |>
                      filter(group == "Species") |>
                      pull(color))
```

By Age

```{r}

# Sorting ages into groups


# plotting

ggplot(data = pheno_expr_data_joined,
       mapping = aes(x = age,
                     fill = species)) +
  geom_boxplot() +
  theme_minimal() +
  theme(plot.title.position = "plot",
        panel.grid.minor = element_blank(),
       panel.grid.major = element_blank(),
       axis.text.y = element_blank()) +
  labs(title = "Distribution of Age",
       subtitle = "of chimpanzees, humans and macaque") +
  scale_fill_manual(values = color_palette |>
                      filter(group == "Species") |>
                      pull(color))

```
